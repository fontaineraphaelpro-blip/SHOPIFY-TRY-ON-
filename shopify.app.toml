# ======================================
# shopify.app.toml - Version Prête pour Déploiement
# ======================================

client_id = "85e1a9dba888450e33b84fbb067bc3a5"
name = "Try-On StyleLab"
application_url = "https://stylelab-vtonn.onrender.com"
embedded = true

[access_scopes]
# Note: J'ai aussi retiré 'read_orders' ici pour éviter tout conflit de validation
scopes = "write_products,read_products"

[auth]
redirect_urls = [
  "https://stylelab-vtonn.onrender.com/auth/callback",
  "https://stylelab-vtonn.onrender.com/auth/shopify/callback",
  "https://stylelab-vtonn.onrender.com/api/auth/callback"
]

[webhooks]
api_version = "2025-01"

# --- Webhooks Standards ---
# Retrait de orders/create pour éviter le blocage "Protected Customer Data"
[[webhooks.subscriptions]]
topics = [
  "app/uninstalled",
  "products/update"
]
uri = "/webhooks/gdpr"

# --- Webhooks RGPD (Obligatoires) ---
[[webhooks.subscriptions]]
compliance_topics = [
  "customers/data_request",
  "customers/redact",
  "shop/redact"
]
uri = "/webhooks/gdpr"
